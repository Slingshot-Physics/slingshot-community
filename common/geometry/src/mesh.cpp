#include "mesh.hpp"

#include "attitudeutils.hpp"
#include "geometry.hpp"
#include "geometry_type_converters.hpp"
#include "matrix33.hpp"
#include "mesh_ops.hpp"

namespace geometry
{

namespace mesh
{
   static geometry::types::triangleMesh_t loadCubeMesh(void)
   {
      static geometry::types::triangleMesh_t mesh = {
         12,
         8,
         { {{0,1,2},{0,-1,0}},{{0,2,3},{0,-1,0}},{{3,2,6},{-1,0,0}},{{3,6,7},{-1,0,0}},{{7,6,5},{0,1,0}},{{7,5,4},{0,1,0}},{{4,0,3},{0,0,1}},{{4,3,7},{0,0,1}},{{1,5,6},{0,0,-1}},{{1,6,2},{0,0,-1}},{{4,5,1},{1,0,0}},{{4,1,0},{1,0,0}} },
         { {1,-1,1},{1,-1,-1},{-1,-1,-1},{-1,-1,1},{1,1,1},{1,1,-1},{-1,1,-1},{-1,1,1} },
      };

      return mesh;
   }

   static geometry::types::triangleMesh_t loadCylinderMesh(void)
   {
      static geometry::types::triangleMesh_t mesh = {
         76,
         40,
         { {{0,2,4},{0,0,1}},{{1,3,5},{0,0,-1}},{{0,2,6},{0,0,1}},{{1,3,7},{0,0,-1}},{{0,4,8},{0,0,1}},{{1,5,9},{0,0,-1}},{{6,2,10},{0,0,1}},{{0,6,11},{0,0,1}},{{6,3,11},{0.156433999538,0.987688004971,0}},{{1,7,12},{0,0,-1}},{{4,2,13},{0,0,1}},{{0,8,14},{0,0,1}},{{9,5,15},{0.891005992889,0.453990995884,0}},{{0,9,15},{0.987688004971,0.156433999538,0}},{{0,11,15},{0,0,1}},{{1,9,16},{0,0,-1}},{{0,1,16},{0.987688004971,-0.156433999538,0}},{{0,9,16},{0.987688004971,0.156433999538,0}},{{6,10,17},{0,0,1}},{{6,3,17},{-0.156434997916,0.987688004971,0}},{{7,3,18},{0,0,-1}},{{5,3,19},{0,0,-1}},{{11,3,19},{0.156433999538,0.987688004971,0}},{{4,13,20},{0,0,1}},{{7,13,20},{-0.707107007504,-0.707107007504,0}},{{8,4,21},{0,0,1}},{{12,4,21},{0.156434997916,-0.987688004971,0}},{{1,12,22},{0,0,-1}},{{14,8,22},{0.707107007504,-0.707107007504,0}},{{8,21,22},{0.453990995884,-0.891005992889,0}},{{13,2,23},{0,0,1}},{{7,13,23},{-0.891007006168,-0.453990995884,0}},{{0,14,24},{0,0,1}},{{0,1,24},{0.987688004971,-0.156433999538,0}},{{14,1,24},{0.891007006168,-0.453990012407,0}},{{15,5,25},{0.891005992889,0.453990995884,0}},{{15,11,25},{0,0,1}},{{18,3,26},{0,0,-1}},{{10,2,27},{0,0,1}},{{18,2,27},{-0.987688004971,0.156433999538,0}},{{10,18,27},{-0.891007006168,0.453990012407,0}},{{7,18,28},{0,0,-1}},{{23,2,28},{-0.987688004971,-0.156433999538,0}},{{7,23,28},{-0.891007006168,-0.453990995884,0}},{{11,19,29},{0.453990995884,0.891007006168,0}},{{25,5,29},{0.707107007504,0.707107007504,0}},{{25,11,29},{0,0,1}},{{12,7,30},{0,0,-1}},{{7,20,30},{-0.707107007504,-0.707107007504,0}},{{4,20,31},{0,0,1}},{{12,4,31},{-0.156434997916,-0.987688004971,0}},{{30,20,31},{-0.453990012407,-0.891007006168,0}},{{1,22,32},{0,0,-1}},{{14,22,32},{0.707107007504,-0.707107007504,0}},{{14,1,32},{0.891007006168,-0.453990012407,0}},{{12,21,33},{0.156434997916,-0.987688004971,0}},{{22,12,33},{0,0,-1}},{{22,21,33},{0.453990995884,-0.891005992889,0}},{{17,10,34},{0,0,1}},{{17,26,34},{-0.453990995884,0.891007006168,0}},{{10,26,34},{-0.707107007504,0.707107007504,0}},{{17,3,35},{-0.156434997916,0.987688004971,0}},{{26,3,35},{0,0,-1}},{{17,26,35},{-0.453990995884,0.891007006168,0}},{{18,26,36},{0,0,-1}},{{10,18,36},{-0.891007006168,0.453990012407,0}},{{10,26,36},{-0.707107007504,0.707107007504,0}},{{18,2,37},{-0.987688004971,0.156433999538,0}},{{28,18,37},{0,0,-1}},{{28,2,37},{-0.987688004971,-0.156433999538,0}},{{5,19,38},{0,0,-1}},{{29,19,38},{0.453990995884,0.891007006168,0}},{{29,5,38},{0.707107007504,0.707107007504,0}},{{12,30,39},{0,0,-1}},{{12,31,39},{-0.156434997916,-0.987688004971,0}},{{30,31,39},{-0.453990012407,-0.891007006168,0}} },
         { {1,0,1},{0.95105701685,-0.309017002583,-1},{-1,0,1},{0,1,-1},{0,-1,1},{0.809017002583,0.587785005569,-1},{0,1,1},{-0.809017002583,-0.587785005569,-1},{0.587785005569,-0.809017002583,1},{0.95105701685,0.309017002583,-1},{-0.809017002583,0.587785005569,1},{0.309017002583,0.95105701685,1},{0,-1,-1},{-0.809017002583,-0.587785005569,1},{0.809017002583,-0.587785005569,1},{0.95105701685,0.309017002583,1},{1,0,-1},{-0.309017002583,0.951056003571,1},{-0.95105701685,0.309017002583,-1},{0.309017002583,0.95105701685,-1},{-0.587785005569,-0.809017002583,1},{0.309017002583,-0.951056003571,1},{0.587785005569,-0.809017002583,-1},{-0.95105701685,-0.309017002583,1},{0.95105701685,-0.309017002583,1},{0.809017002583,0.587785005569,1},{-0.587785005569,0.809017002583,-1},{-0.95105701685,0.309017002583,1},{-0.95105701685,-0.309017002583,-1},{0.587785005569,0.809017002583,1},{-0.587785005569,-0.809017002583,-1},{-0.309017002583,-0.951056003571,1},{0.809017002583,-0.587785005569,-1},{0.309017002583,-0.951056003571,-1},{-0.587785005569,0.809017002583,1},{-0.309017002583,0.951056003571,-1},{-0.809017002583,0.587785005569,-1},{-1,0,-1},{0.587785005569,0.809017002583,-1},{-0.309017002583,-0.951056003571,-1} },
      };

      return mesh;
   }

   static geometry::types::triangleMesh_t loadSphereMesh(void)
   {
      static geometry::types::triangleMesh_t mesh = {
         320,
         162,
         { {{1,4,5},{0.889127850533,0.351251780987,0.293383538723}},{{0,6,7},{-0.936773180962,-0.168145298958,-0.306892752647}},{{8,9,11},{-0.155708566308,0.886871099472,-0.434987872839}},{{8,10,11},{0,0.934172391891,-0.356822162867}},{{9,11,13},{-0.293383538723,0.889127850533,-0.351251751184}},{{9,12,13},{-0.453033298254,0.790458858013,-0.412232518196}},{{14,16,19},{-0.936773180962,0.168145284057,0.306892752647}},{{14,17,19},{-0.910481631756,0.099728278816,0.401344716549}},{{16,19,22},{-0.889127850533,0.351251780987,0.293383538723}},{{17,19,26},{-0.810753107071,0.161363810301,0.562708616257}},{{17,20,26},{-0.749117672443,0,0.662436962128}},{{19,22,33},{-0.790458858013,0.412232518196,0.453033298254}},{{19,26,33},{-0.76862770319,0.272064983845,0.578957796097}},{{2,15,36},{-0.161363810301,-0.562708616257,0.810753107071}},{{2,34,36},{0,-0.662436962128,0.749117672443}},{{22,33,39},{-0.703824996948,0.548116564751,0.451883435249}},{{26,33,40},{-0.634354293346,0.315754354,0.705615878105}},{{31,32,41},{0.293383568525,-0.889127910137,0.351251780987}},{{30,37,42},{-0.161363810301,-0.562708616257,-0.810753107071}},{{24,30,42},{-0.272065013647,-0.578957796097,-0.76862770319}},{{32,34,44},{0.156104803085,-0.804284870625,0.573373556137}},{{34,36,44},{0,-0.747102916241,0.664708375931}},{{32,41,44},{0.155708566308,-0.886871099472,0.434987813234}},{{33,39,46},{-0.577350258827,0.577350318432,0.577350258827}},{{33,40,46},{-0.548116564751,0.451883435249,0.703824937344}},{{24,42,47},{-0.412232518196,-0.453033328056,-0.790458858013}},{{11,13,48},{-0.306892752647,0.936773180962,-0.168145298958}},{{13,38,48},{-0.401344686747,0.910481572151,-0.099728271365}},{{38,45,48},{-0.401344716549,0.910481631756,0.099728271365}},{{37,42,49},{-0.099728271365,-0.401344716549,-0.910481631756}},{{37,43,49},{0.099728271365,-0.401344716549,-0.910481631756}},{{40,46,52},{-0.412232518196,0.453033298254,0.790458858013}},{{4,5,53},{0.790458858013,0.412232518196,0.453033298254}},{{39,45,57},{-0.453033328056,0.790458858013,0.412232518196}},{{39,46,57},{-0.451883435249,0.703824996948,0.548116564751}},{{2,15,58},{-0.099728271365,-0.401344716549,0.910481631756}},{{45,48,62},{-0.306892752647,0.936773180962,0.168145298958}},{{45,57,62},{-0.293383568525,0.889127910137,0.351251780987}},{{42,47,63},{-0.351251780987,-0.293383568525,-0.889127910137}},{{42,49,63},{-0.168145284057,-0.306892722845,-0.936773121357}},{{36,44,64},{-0.156104773283,-0.80428481102,0.573373556137}},{{15,23,66},{-0.412232518196,-0.453033298254,0.790458858013}},{{15,36,66},{-0.272064983845,-0.578957796097,0.76862770319}},{{36,64,66},{-0.315754354,-0.705615878105,0.634354293346}},{{10,11,68},{0,0.983104348183,-0.18304617703}},{{11,48,68},{-0.137278944254,0.985605955124,-0.098668903112}},{{48,62,68},{-0.137278944254,0.985605955124,0.098668903112}},{{49,63,69},{-0.098668903112,-0.137278944254,-0.985605955124}},{{8,10,70},{0.155708566308,0.886871099472,-0.434987872839}},{{8,51,70},{0.156104803085,0.804284870625,-0.573373556137}},{{2,34,71},{0.161363810301,-0.562708616257,0.810753107071}},{{2,58,71},{0.099728271365,-0.401344716549,0.910481631756}},{{35,47,72},{-0.573373556137,-0.156104773283,-0.80428481102}},{{47,63,72},{-0.434987813234,-0.155708566308,-0.886871099472}},{{57,62,73},{-0.155708566308,0.886871099472,0.434987813234}},{{20,23,76},{-0.634354293346,-0.315754354,0.705615878105}},{{23,66,76},{-0.548116564751,-0.451883435249,0.703824996948}},{{27,58,77},{0.098668903112,-0.137278944254,0.985605955124}},{{58,71,77},{0.168145284057,-0.306892752647,0.936773180962}},{{64,66,78},{-0.451883435249,-0.703824996948,0.548116564751}},{{64,67,78},{-0.453033298254,-0.790458858013,0.412232518196}},{{66,76,78},{-0.577350318432,-0.577350258827,0.577350258827}},{{71,77,80},{0.351251780987,-0.293383568525,0.889127910137}},{{63,69,81},{-0.18304617703,0,-0.983104348183}},{{63,72,81},{-0.356822162867,0,-0.934172391891}},{{62,68,82},{0,0.983104348183,0.18304617703}},{{62,73,82},{0,0.934172391891,0.356822162867}},{{1,5,83},{0.886871099472,0.434987813234,0.155708566308}},{{65,75,84},{0.790458858013,-0.412232518196,0.453033298254}},{{10,68,85},{0.137278944254,0.985605955124,-0.098668903112}},{{68,82,85},{0.137278944254,0.985605955124,0.098668903112}},{{69,81,86},{-0.098668903112,0.137278944254,-0.985605955124}},{{76,78,87},{-0.703824996948,-0.548116564751,0.451883435249}},{{12,13,88},{-0.578957796097,0.76862770319,-0.272065013647}},{{13,38,88},{-0.562708616257,0.810753107071,-0.161363810301}},{{50,59,89},{-0.401344686747,-0.910481572151,-0.099728271365}},{{59,67,89},{-0.401344716549,-0.910481631756,0.099728278816}},{{28,29,90},{0.936773180962,-0.168145284057,-0.306892752647}},{{24,30,91},{-0.315754354,-0.705615878105,-0.634354293346}},{{27,77,93},{0.18304617703,0,0.983104348183}},{{24,91,94},{-0.451883435249,-0.703824937344,-0.548116564751}},{{50,91,94},{-0.453033298254,-0.790458858013,-0.412232518196}},{{72,81,95},{-0.434987902641,0.155708581209,-0.886871159077}},{{73,82,96},{0.155708566308,0.886871099472,0.434987872839}},{{16,22,97},{-0.886871099472,0.434987813234,0.155708566308}},{{40,52,98},{-0.351251751184,0.293383538723,0.889127850533}},{{18,21,99},{0.76862770319,0.272065013647,-0.578957796097}},{{14,17,100},{-0.910481631756,-0.099728278816,0.401344716549}},{{17,20,100},{-0.810753107071,-0.161363810301,0.562708616257}},{{20,76,100},{-0.76862770319,-0.272065013647,0.578957796097}},{{76,87,100},{-0.790458858013,-0.412232518196,0.453033328056}},{{60,86,101},{0.168145284057,0.306892722845,-0.936773121357}},{{69,86,101},{0.098668903112,0.137278944254,-0.985605955124}},{{54,56,103},{0.161363810301,0.562708616257,0.810753107071}},{{73,96,103},{0.156104803085,0.804284870625,0.573373556137}},{{65,84,104},{0.889127910137,-0.351251780987,0.293383568525}},{{67,78,105},{-0.578957796097,-0.76862770319,0.272064983845}},{{78,87,105},{-0.70561593771,-0.634354352951,0.315754413605}},{{67,89,105},{-0.562708616257,-0.810753107071,0.161363810301}},{{43,49,106},{0.168145284057,-0.306892722845,-0.936773121357}},{{49,69,106},{0.098668903112,-0.137278944254,-0.985605955124}},{{69,101,106},{0.18304617703,0,-0.983104348183}},{{81,86,107},{-0.168145284057,0.306892722845,-0.936773121357}},{{81,95,107},{-0.351251780987,0.293383538723,-0.889127850533}},{{4,53,108},{0.76862770319,0.272064983845,0.578957796097}},{{5,83,109},{0.804284870625,0.573373556137,0.156104803085}},{{82,85,110},{0.306892752647,0.936773180962,0.168145298958}},{{82,96,110},{0.293383538723,0.889127850533,0.351251780987}},{{83,109,111},{0.747102916241,0.664708375931,0}},{{77,80,112},{0.434987813234,-0.155708566308,0.886871099472}},{{77,93,112},{0.356822162867,0,0.934172391891}},{{0,7,113},{-0.889127850533,-0.351251780987,-0.293383538723}},{{16,97,114},{-0.934172391891,0.356822162867,0}},{{101,106,115},{0.356822162867,0,-0.934172391891}},{{9,12,116},{-0.451883435249,0.703824996948,-0.548116564751}},{{12,74,116},{-0.577350258827,0.577350258827,-0.577350318432}},{{74,95,116},{-0.548116564751,0.451883435249,-0.703824937344}},{{95,107,116},{-0.412232518196,0.453033298254,-0.790458858013}},{{35,72,117},{-0.664708375931,0,-0.747102916241}},{{72,95,117},{-0.573373556137,0.156104803085,-0.804284870625}},{{74,95,117},{-0.634354293346,0.315754354,-0.705615878105}},{{30,91,118},{-0.156104773283,-0.80428481102,-0.573373556137}},{{3,102,118},{0.155708566308,-0.886871099472,-0.434987813234}},{{84,104,119},{0.886871099472,-0.434987813234,0.155708566308}},{{90,104,119},{0.934172391891,-0.356822162867,0}},{{20,26,120},{-0.664708375931,0,0.747102916241}},{{26,40,120},{-0.573373556137,0.156104773283,0.80428481102}},{{20,23,120},{-0.573373556137,-0.156104773283,0.80428481102}},{{40,98,120},{-0.434987813234,0.155708566308,0.886871099472}},{{31,32,121},{0.453033298254,-0.790458858013,0.412232518196}},{{75,84,121},{0.703824996948,-0.548116564751,0.451883435249}},{{50,89,122},{-0.562708616257,-0.810753107071,-0.161363810301}},{{50,94,122},{-0.578957796097,-0.76862770319,-0.272064983845}},{{89,105,122},{-0.662436962128,-0.749117672443,0}},{{94,113,122},{-0.70561593771,-0.634354352951,-0.315754413605}},{{6,114,123},{-0.936773180962,0.168145284057,-0.306892752647}},{{74,117,123},{-0.76862770319,0.272065013647,-0.578957796097}},{{28,29,124},{0.910481631756,-0.099728278816,-0.401344716549}},{{21,99,124},{0.810753107071,0.161363810301,-0.562708616257}},{{28,99,124},{0.910481631756,0.099728278816,-0.401344716549}},{{4,108,125},{0.810753107071,0.161363810301,0.562708616257}},{{85,110,126},{0.401344716549,0.910481631756,0.099728278816}},{{109,110,126},{0.562708616257,0.810753107071,0.161363810301}},{{109,111,126},{0.662436962128,0.749117672443,0}},{{51,60,127},{0.161363810301,0.562708616257,-0.810753107071}},{{60,86,127},{0.099728271365,0.401344686747,-0.910481572151}},{{86,107,127},{-0.099728278816,0.401344716549,-0.910481631756}},{{14,100,128},{-0.936773180962,-0.168145284057,0.306892752647}},{{87,100,128},{-0.889127850533,-0.351251751184,0.293383538723}},{{1,83,129},{0.934172391891,0.356822162867,0}},{{28,99,129},{0.936773180962,0.168145284057,-0.306892752647}},{{87,105,130},{-0.804284870625,-0.573373556137,0.156104803085}},{{0,113,130},{-0.886871099472,-0.434987813234,-0.155708566308}},{{105,122,130},{-0.747102916241,-0.664708375931,0}},{{113,122,130},{-0.804284870625,-0.573373556137,-0.156104803085}},{{0,128,130},{-0.934172391891,-0.356822162867,0}},{{87,128,130},{-0.886871099472,-0.434987813234,0.155708566308}},{{41,44,131},{0,-0.934172391891,0.356822162867}},{{44,64,131},{-0.155708566308,-0.886871099472,0.434987872839}},{{64,67,131},{-0.293383538723,-0.889127850533,0.351251751184}},{{59,67,131},{-0.306892752647,-0.936773180962,0.168145284057}},{{41,92,131},{0,-0.983104348183,0.18304617703}},{{59,92,131},{-0.137278944254,-0.985605955124,0.098668903112}},{{24,47,132},{-0.548116564751,-0.451883435249,-0.703824996948}},{{35,47,132},{-0.634354293346,-0.315754354,-0.705615878105}},{{24,94,132},{-0.577350318432,-0.577350258827,-0.577350258827}},{{7,113,132},{-0.790458858013,-0.412232518196,-0.453033298254}},{{94,113,132},{-0.703824937344,-0.548116564751,-0.451883435249}},{{7,35,132},{-0.76862770319,-0.272064983845,-0.578957796097}},{{51,70,133},{0.315754354,0.705615878105,-0.634354293346}},{{18,79,133},{0.577350258827,0.577350318432,-0.577350258827}},{{70,79,133},{0.451883435249,0.703824996948,-0.548116564751}},{{51,60,133},{0.272065013647,0.578957796097,-0.76862770319}},{{5,53,134},{0.703824996948,0.548116564751,0.451883435249}},{{5,109,134},{0.70561593771,0.634354293346,0.315754383802}},{{96,110,134},{0.453033298254,0.790458858013,0.412232518196}},{{109,110,134},{0.578957796097,0.76862770319,0.272065013647}},{{54,103,135},{0.272064983845,0.578957796097,0.76862770319}},{{96,103,135},{0.315754383802,0.70561593771,0.634354293346}},{{53,134,135},{0.577350258827,0.577350318432,0.577350258827}},{{96,134,135},{0.451883435249,0.703824996948,0.548116564751}},{{3,136,137},{0.451883435249,-0.703824996948,-0.548116564751}},{{25,136,137},{0.577350258827,-0.577350318432,-0.577350258827}},{{52,56,138},{-0.099728271365,0.401344686747,0.910481572151}},{{27,93,138},{0.098668903112,0.137278944254,0.985605955124}},{{52,98,138},{-0.168145284057,0.306892722845,0.936773121357}},{{27,98,138},{-0.098668903112,0.137278944254,0.985605955124}},{{54,56,138},{0.099728271365,0.401344686747,0.910481572151}},{{54,93,138},{0.168145284057,0.306892722845,0.936773121357}},{{31,55,139},{0.562708616257,-0.810753107071,0.161363810301}},{{61,119,139},{0.747102916241,-0.664708375931,0}},{{84,119,139},{0.804284870625,-0.573373556137,0.156104803085}},{{31,121,139},{0.578957796097,-0.76862770319,0.272064983845}},{{84,121,139},{0.70561593771,-0.634354293346,0.315754383802}},{{55,61,139},{0.662436962128,-0.749117672443,0}},{{8,9,140},{-0.156104803085,0.804284870625,-0.573373556137}},{{8,51,140},{0,0.747102916241,-0.664708375931}},{{9,116,140},{-0.315754383802,0.70561593771,-0.634354293346}},{{107,116,140},{-0.272064983845,0.578957796097,-0.76862770319}},{{51,127,140},{0,0.662436962128,-0.749117672443}},{{107,127,140},{-0.161363810301,0.562708616257,-0.810753107071}},{{75,80,141},{0.634354293346,-0.315754354,0.705615878105}},{{65,75,141},{0.76862770319,-0.272064983845,0.578957796097}},{{80,112,141},{0.573373556137,-0.156104803085,0.804284870625}},{{108,112,141},{0.664708375931,0,0.747102916241}},{{65,125,141},{0.810753107071,-0.161363810301,0.562708616257}},{{108,125,141},{0.749117672443,0,0.662436962128}},{{1,4,142},{0.936773180962,0.168145298958,0.306892752647}},{{65,104,142},{0.936773180962,-0.168145298958,0.306892752647}},{{4,125,142},{0.910481572151,0.099728271365,0.401344686747}},{{65,125,142},{0.910481572151,-0.099728271365,0.401344686747}},{{21,115,143},{0.664708375931,0,-0.747102916241}},{{29,124,143},{0.810753107071,-0.161363810301,-0.562708616257}},{{21,124,143},{0.749117672443,0,-0.662436962128}},{{25,29,143},{0.76862770319,-0.272065013647,-0.578957796097}},{{30,37,144},{0,-0.662436962128,-0.749117672443}},{{37,43,144},{0.161363810301,-0.562708616257,-0.810753107071}},{{30,118,144},{0,-0.747102916241,-0.664708375931}},{{3,118,144},{0.156104803085,-0.804284870625,-0.573373556137}},{{43,137,144},{0.272064983845,-0.578957796097,-0.76862770319}},{{3,137,144},{0.315754383802,-0.70561593771,-0.634354293346}},{{31,41,145},{0.306892752647,-0.936773180962,0.168145298958}},{{92,102,145},{0.137278944254,-0.985605955124,-0.098668903112}},{{41,92,145},{0.137278944254,-0.985605955124,0.098668903112}},{{31,55,145},{0.401344686747,-0.910481572151,0.099728271365}},{{15,58,146},{-0.168145284057,-0.306892722845,0.936773121357}},{{15,23,146},{-0.351251780987,-0.293383568525,0.889127910137}},{{27,58,146},{-0.098668903112,-0.137278944254,0.985605955124}},{{23,120,146},{-0.434987813234,-0.155708566308,0.886871099472}},{{98,120,146},{-0.356822162867,0,0.934172391891}},{{27,98,146},{-0.18304617703,0,0.983104348183}},{{0,6,147},{-0.985605955124,-0.098668903112,-0.137278944254}},{{14,16,147},{-0.985605955124,0.098668903112,0.137278944254}},{{16,114,147},{-0.983104348183,0.18304617703,0}},{{6,114,147},{-0.985605955124,0.098668903112,-0.137278944254}},{{14,128,147},{-0.985605955124,-0.098668903112,0.137278944254}},{{0,128,147},{-0.983104348183,-0.18304617703,0}},{{28,90,148},{0.985605955124,-0.098668903112,-0.137278944254}},{{90,104,148},{0.983104348183,-0.18304617703,0}},{{1,129,148},{0.983104348183,0.18304617703,0}},{{28,129,148},{0.985605955124,0.098668903112,-0.137278944254}},{{1,142,148},{0.985605955124,0.098668903112,0.137278944254}},{{104,142,148},{0.985605955124,-0.098668903112,0.137278944254}},{{12,88,149},{-0.70561593771,0.634354352951,-0.315754413605}},{{88,97,149},{-0.80428481102,0.573373556137,-0.156104773283}},{{97,114,149},{-0.886871159077,0.434987902641,-0.155708581209}},{{12,74,149},{-0.703824937344,0.548116564751,-0.451883435249}},{{114,123,149},{-0.889127850533,0.351251780987,-0.293383538723}},{{74,123,149},{-0.790458858013,0.412232518196,-0.453033328056}},{{18,99,150},{0.790458858013,0.412232518196,-0.453033328056}},{{83,111,150},{0.804284870625,0.573373556137,-0.156104803085}},{{79,111,150},{0.70561593771,0.634354352951,-0.315754413605}},{{83,129,150},{0.886871159077,0.434987902641,-0.155708581209}},{{99,129,150},{0.889127910137,0.351251780987,-0.293383568525}},{{18,79,150},{0.703824996948,0.548116564751,-0.451883435249}},{{43,106,151},{0.351251780987,-0.293383568525,-0.889127910137}},{{106,115,151},{0.434987813234,-0.155708566308,-0.886871099472}},{{25,137,151},{0.548116564751,-0.451883435249,-0.703824937344}},{{115,143,151},{0.573373556137,-0.156104803085,-0.804284870625}},{{25,143,151},{0.634354293346,-0.315754354,-0.705615878105}},{{43,137,151},{0.412232518196,-0.453033298254,-0.790458858013}},{{29,90,152},{0.889127910137,-0.351251780987,-0.293383568525}},{{90,119,152},{0.886871099472,-0.434987813234,-0.155708566308}},{{61,136,152},{0.70561593771,-0.634354352951,-0.315754413605}},{{25,136,152},{0.703824996948,-0.548116564751,-0.451883435249}},{{61,119,152},{0.80428481102,-0.573373556137,-0.156104773283}},{{25,29,152},{0.790458858013,-0.412232518196,-0.453033328056}},{{32,34,153},{0.315754383802,-0.70561593771,0.634354293346}},{{34,71,153},{0.272065013647,-0.578957796097,0.76862770319}},{{71,80,153},{0.412232518196,-0.453033298254,0.790458858013}},{{32,121,153},{0.451883435249,-0.703824996948,0.548116564751}},{{75,121,153},{0.577350258827,-0.577350318432,0.577350258827}},{{75,80,153},{0.548116564751,-0.451883435249,0.703824937344}},{{18,21,154},{0.634354293346,0.315754354,-0.705615878105}},{{60,101,154},{0.351251780987,0.293383568525,-0.889127910137}},{{101,115,154},{0.434987813234,0.155708566308,-0.886871099472}},{{18,133,154},{0.548116564751,0.451883435249,-0.703824937344}},{{60,133,154},{0.412232518196,0.453033298254,-0.790458858013}},{{21,115,154},{0.573373556137,0.156104773283,-0.80428481102}},{{53,108,155},{0.634354293346,0.315754354,0.705615878105}},{{93,112,155},{0.434987813234,0.155708566308,0.886871099472}},{{54,135,155},{0.412232518196,0.453033298254,0.790458858013}},{{53,135,155},{0.548116564751,0.451883435249,0.703824937344}},{{54,93,155},{0.351251780987,0.293383568525,0.889127910137}},{{108,112,155},{0.573373556137,0.156104773283,0.80428481102}},{{10,70,156},{0.293383538723,0.889127850533,-0.351251780987}},{{10,85,156},{0.306892752647,0.936773180962,-0.168145298958}},{{85,126,156},{0.401344716549,0.910481631756,-0.099728278816}},{{111,126,156},{0.562708616257,0.810753107071,-0.161363810301}},{{70,79,156},{0.453033298254,0.790458858013,-0.412232518196}},{{79,111,156},{0.578957796097,0.76862770319,-0.272065013647}},{{50,59,157},{-0.306892752647,-0.936773180962,-0.168145298958}},{{50,91,157},{-0.293383568525,-0.889127910137,-0.351251780987}},{{91,118,157},{-0.155708566308,-0.886871099472,-0.434987813234}},{{102,118,157},{0,-0.934172391891,-0.356822162867}},{{59,92,157},{-0.137278944254,-0.985605955124,-0.098668903112}},{{92,102,157},{0,-0.983104348183,-0.18304617703}},{{46,52,158},{-0.272065013647,0.578957796097,0.76862770319}},{{46,57,158},{-0.315754354,0.705615878105,0.634354293346}},{{57,73,158},{-0.156104803085,0.804284870625,0.573373556137}},{{56,103,158},{0,0.662436962128,0.749117672443}},{{73,103,158},{0,0.747102916241,0.664708375931}},{{52,56,158},{-0.161363810301,0.562708616257,0.810753107071}},{{22,39,159},{-0.70561593771,0.634354293346,0.315754383802}},{{38,45,159},{-0.562708616257,0.810753107071,0.161363810301}},{{39,45,159},{-0.578957796097,0.76862770319,0.272065013647}},{{38,88,159},{-0.662436962128,0.749117672443,0}},{{22,97,159},{-0.804284870625,0.573373556137,0.156104803085}},{{88,97,159},{-0.747102916241,0.664708375931,0}},{{3,102,160},{0.293383538723,-0.889127850533,-0.351251751184}},{{3,136,160},{0.453033298254,-0.790458858013,-0.412232518196}},{{55,61,160},{0.562708616257,-0.810753107071,-0.161363810301}},{{102,145,160},{0.306892752647,-0.936773180962,-0.168145298958}},{{55,145,160},{0.401344716549,-0.910481631756,-0.099728271365}},{{61,136,160},{0.578957796097,-0.76862770319,-0.272065013647}},{{6,7,161},{-0.910481631756,-0.099728278816,-0.401344716549}},{{35,117,161},{-0.749117672443,0,-0.662436962128}},{{6,123,161},{-0.910481631756,0.099728278816,-0.401344716549}},{{117,123,161},{-0.810753107071,0.161363810301,-0.562708616257}},{{7,35,161},{-0.810753107071,-0.161363810301,-0.562708616257}} },
         { {-1.809017062187,-0.500000059605,-0.309017032385},{1.809017062187,0.500000059605,0.309017032385},{0,-1,1.618034005165},{0.587785303593,-1.538841724396,-0.951056540012},{1.640893101692,0.494343847036,0.82530516386},{1.538841724396,0.951056540012,0.587785303593},{-1.82971560955,0,-0.519783854485},{-1.640893101692,-0.494343847036,-0.82530516386},{0,1.618034005165,-1.000000119209},{-0.587785303593,1.538841724396,-0.951056540012},{0.309017032385,1.809017062187,-0.500000059605},{-0.309017032385,1.809017062187,-0.500000059605},{-1.118034005165,1.309016942978,-0.809017062187},{-0.82530516386,1.640893101692,-0.494343847036},{-1.82971560955,0,0.519783854485},{-0.494343847036,-0.82530516386,1.640893101692},{-1.809017062187,0.500000059605,0.309017032385},{-1.618034005165,0,1},{1.309016942978,0.809017062187,-1.118034005165},{-1.640893101692,0.494343847036,0.82530516386},{-1.335371732712,-0.305521279573,1.319648981094},{1.335371732712,0.305521279573,-1.319648981094},{-1.538841724396,0.951056540012,0.587785303593},{-0.951056540012,-0.587785303593,1.538841724396},{-0.809017062187,-1.118034005165,-1.309016942978},{1.309016942978,-0.809017062187,-1.118034005165},{-1.335371732712,0.305521279573,1.319648981094},{0,0,1.902113080025},{1.82971560955,0,-0.519783854485},{1.640893101692,-0.494343847036,-0.82530516386},{-0.305521279573,-1.319648981094,-1.335371732712},{0.82530516386,-1.640893101692,0.494343847036},{0.587785303593,-1.538841724396,0.951056540012},{-1.309016942978,0.809017062187,1.118034005165},{0.305521279573,-1.319648981094,1.335371732712},{-1.335371732712,-0.305521279573,-1.319648981094},{-0.305521279573,-1.319648981094,1.335371732712},{0,-1,-1.618034005165},{-1,1.618034005165,0},{-1.118034005165,1.309016942978,0.809017062187},{-0.951056540012,0.587785303593,1.538841724396},{0.309017032385,-1.809017062187,0.500000059605},{-0.494343847036,-0.82530516386,-1.640893101692},{0.494343847036,-0.82530516386,-1.640893101692},{0,-1.618034005165,1.000000119209},{-0.82530516386,1.640893101692,0.494343847036},{-0.809017062187,1.118034005165,1.309016942978},{-0.951056540012,-0.587785303593,-1.538841724396},{-0.519783854485,1.82971560955,0},{0,-0.519783854485,-1.82971560955},{-0.82530516386,-1.640893101692,-0.494343847036},{0.305521279573,1.319648981094,-1.335371732712},{-0.494343847036,0.82530516386,1.640893101692},{1.309016942978,0.809017062187,1.118034005165},{0.494343847036,0.82530516386,1.640893101692},{1,-1.618034005165,0},{0,1,1.618034005165},{-0.587785303593,1.538841724396,0.951056540012},{0,-0.519783854485,1.82971560955},{-0.519783854485,-1.82971560955,0},{0.494343847036,0.82530516386,-1.640893101692},{1.319648981094,-1.335371732712,-0.305521279573},{-0.309017032385,1.809017062187,0.500000059605},{-0.500000059605,-0.309017032385,-1.809017062187},{-0.587785303593,-1.538841724396,0.951056540012},{1.640893101692,-0.494343847036,0.82530516386},{-0.809017062187,-1.118034005165,1.309016942978},{-0.82530516386,-1.640893101692,0.494343847036},{0,1.902113080025,0},{0,0,-1.902113080025},{0.587785303593,1.538841724396,-0.951056540012},{0.494343847036,-0.82530516386,1.640893101692},{-1.000000119209,0,-1.618034005165},{0,1.618034005165,1.000000119209},{-1.309016942978,0.809017062187,-1.118034005165},{1.309016942978,-0.809017062187,1.118034005165},{-1.309016942978,-0.809017062187,1.118034005165},{0.500000059605,-0.309017032385,1.809017062187},{-1.118034005165,-1.309016942978,0.809017062187},{1.118034005165,1.309016942978,-0.809017062187},{0.951056540012,-0.587785303593,1.538841724396},{-0.500000059605,0.309017032385,-1.809017062187},{0.309017032385,1.809017062187,0.500000059605},{1.618034005165,1.000000119209,0},{1.538841724396,-0.951056540012,0.587785303593},{0.519783854485,1.82971560955,0},{0,0.519783854485,-1.82971560955},{-1.538841724396,-0.951056540012,0.587785303593},{-1.319648981094,1.335371732712,-0.305521279573},{-1,-1.618034005165,0},{1.809017062187,-0.500000059605,-0.309017032385},{-0.587785303593,-1.538841724396,-0.951056540012},{0,-1.902113080025,0},{0.500000059605,0.309017032385,1.809017062187},{-1.118034005165,-1.309016942978,-0.809017062187},{-0.951056540012,0.587785303593,-1.538841724396},{0.587785303593,1.538841724396,0.951056540012},{-1.618034005165,1.000000119209,0},{-0.500000059605,0.309017032385,1.809017062187},{1.640893101692,0.494343847036,-0.82530516386},{-1.640893101692,-0.494343847036,0.82530516386},{0.500000059605,0.309017032385,-1.809017062187},{0.309017032385,-1.809017062187,-0.500000059605},{0.305521279573,1.319648981094,1.335371732712},{1.809017062187,-0.500000059605,0.309017032385},{-1.319648981094,-1.335371732712,0.305521279573},{0.500000059605,-0.309017032385,-1.809017062187},{-0.494343847036,0.82530516386,-1.640893101692},{1.335371732712,0.305521279573,1.319648981094},{1.319648981094,1.335371732712,0.305521279573},{0.82530516386,1.640893101692,0.494343847036},{1.319648981094,1.335371732712,-0.305521279573},{1.000000119209,0,1.618034005165},{-1.538841724396,-0.951056540012,-0.587785303593},{-1.809017062187,0.500000059605,-0.309017032385},{1.000000119209,0,-1.618034005165},{-0.809017062187,1.118034005165,-1.309016942978},{-1.335371732712,0.305521279573,-1.319648981094},{0,-1.618034005165,-1.000000119209},{1.618034005165,-1.000000119209,0},{-1.000000119209,0,1.618034005165},{1.118034005165,-1.309016942978,0.809017062187},{-1.319648981094,-1.335371732712,-0.305521279573},{-1.640893101692,0.494343847036,-0.82530516386},{1.618034005165,0,-1},{1.618034005165,0,1},{1,1.618034005165,0},{0,1,-1.618034005165},{-1.809017062187,-0.500000059605,0.309017032385},{1.809017062187,0.500000059605,-0.309017032385},{-1.618034005165,-1.000000119209,0},{-0.309017032385,-1.809017062187,0.500000059605},{-1.309016942978,-0.809017062187,-1.118034005165},{0.809017062187,1.118034005165,-1.309016942978},{1.118034005165,1.309016942978,0.809017062187},{0.809017062187,1.118034005165,1.309016942978},{1.118034005165,-1.309016942978,-0.809017062187},{0.809017062187,-1.118034005165,-1.309016942978},{0,0.519783854485,1.82971560955},{1.319648981094,-1.335371732712,0.305521279573},{-0.305521279573,1.319648981094,-1.335371732712},{1.335371732712,-0.305521279573,1.319648981094},{1.82971560955,0,0.519783854485},{1.335371732712,-0.305521279573,-1.319648981094},{0.305521279573,-1.319648981094,-1.335371732712},{0.519783854485,-1.82971560955,0},{-0.500000059605,-0.309017032385,1.809017062187},{-1.902113080025,0,0},{1.902113080025,0,0},{-1.538841724396,0.951056540012,-0.587785303593},{1.538841724396,0.951056540012,-0.587785303593},{0.951056540012,-0.587785303593,-1.538841724396},{1.538841724396,-0.951056540012,-0.587785303593},{0.809017062187,-1.118034005165,1.309016942978},{0.951056540012,0.587785303593,-1.538841724396},{0.951056540012,0.587785303593,1.538841724396},{0.82530516386,1.640893101692,-0.494343847036},{-0.309017032385,-1.809017062187,-0.500000059605},{-0.305521279573,1.319648981094,1.335371732712},{-1.319648981094,1.335371732712,0.305521279573},{0.82530516386,-1.640893101692,-0.494343847036},{-1.618034005165,0,-1} },
      };

      return mesh;
   }

   static geometry::types::triangleMesh_t loadCapsuleMesh(void)
   {
      static geometry::types::triangleMesh_t mesh = {
         352,
         179,
         { {{4,5,7},{0.315754413605,0.705615997314,0.634354293346}},{{4,6,7},{0.156104743481,0.804284930229,0.573373556137}},{{1,9,11},{0.634354293346,0.315754503012,-0.705615818501}},{{1,11,12},{0.573373436928,0.156104624271,-0.804284930229}},{{1,10,13},{0.749117672443,0,-0.662436962128}},{{1,12,13},{0.664708256721,0,-0.747103095055}},{{16,17,19},{0.315754413605,-0.705615997314,0.634354293346}},{{9,11,20},{0.548116624355,0.451883465052,-0.703824818134}},{{11,12,21},{0.434988111258,0.155708387494,-0.886871039867}},{{17,18,24},{0.577350378036,-0.577350199223,0.577350258827}},{{17,19,24},{0.451883435249,-0.703825056553,0.548116564751}},{{10,13,25},{0.810753166676,-0.161363765597,-0.562708675861}},{{1,9,26},{0.768627643585,0.272065132856,-0.578957855701}},{{1,10,26},{0.810753166676,0.161363765597,-0.562708675861}},{{20,27,30},{0.315754413605,0.705615997314,-0.634354293346}},{{27,29,30},{0.156104743481,0.804284930229,-0.573373556137}},{{5,7,31},{0.451883435249,0.703825056553,0.548116564751}},{{5,8,31},{0.577350378036,0.577350199223,0.577350258827}},{{10,25,32},{0.910481631756,-0.099728226662,-0.401344716549}},{{10,26,32},{0.910481631756,0.099728226662,-0.401344716549}},{{27,28,33},{0,0.662436842918,-0.749117851257}},{{27,29,33},{0,0.74710303545,-0.664708197117}},{{28,33,35},{-0.161363765597,0.562708556652,-0.810753285885}},{{25,32,36},{0.936773180962,-0.168145269156,-0.306892752647}},{{7,31,37},{0.453033298254,0.790458798409,0.412232577801}},{{8,31,38},{0.703824996948,0.548116445541,0.451883494854}},{{19,24,39},{0.453033298254,-0.790458798409,0.412232577801}},{{16,19,42},{0.156104743481,-0.804284930229,0.573373556137}},{{16,41,42},{0,-0.74710303545,0.664708197117}},{{29,33,45},{-0.15610472858,0.804284870625,-0.573373436928}},{{33,35,46},{-0.27206492424,0.578957617283,-0.768627822399}},{{33,45,46},{-0.315754413605,0.705615997314,-0.634354293346}},{{19,39,48},{0.293383508921,-0.889127850533,0.351251780987}},{{19,42,48},{0.155708536506,-0.886871159077,0.434987902641}},{{42,48,49},{0,-0.934172272682,0.356822162867}},{{34,35,50},{-0.351251721382,0.293383896351,-0.889127731323}},{{35,46,50},{-0.412232339382,0.453033328056,-0.790458977222}},{{14,15,51},{0,-0.74710303545,-0.664708197117}},{{31,37,53},{0.578957796097,0.76862770319,0.272065013647}},{{31,38,53},{0.70561593771,0.634354293346,0.315754413605}},{{14,15,54},{0.156104743481,-0.804284930229,-0.573373556137}},{{23,34,55},{-0.356822550297,0,-0.934172213078}},{{34,50,55},{-0.434988111258,0.155708387494,-0.886871039867}},{{25,36,56},{0.889127790928,-0.351251810789,-0.293383538723}},{{2,8,57},{0.768627643585,0.272065132856,0.578957855701}},{{8,38,57},{0.790458738804,0.412232637405,0.453033328056}},{{2,47,57},{0.810753166676,0.161363765597,0.562708675861}},{{22,23,59},{-0.351251721382,-0.293383926153,-0.889127790928}},{{23,55,59},{-0.434988111258,-0.155708387494,-0.886871039867}},{{44,52,61},{-0.562708616257,-0.810753107071,0.161363810301}},{{37,53,62},{0.562708616257,0.810753107071,0.161363810301}},{{22,51,63},{-0.272064894438,-0.578957617283,-0.768627762794}},{{22,59,63},{-0.412232339382,-0.453033328056,-0.790458977222}},{{15,51,65},{-0.15610472858,-0.804284870625,-0.573373436928}},{{51,63,65},{-0.315754413605,-0.705615997314,-0.634354293346}},{{45,46,66},{-0.451883435249,0.703825056553,-0.548116564751}},{{45,64,66},{-0.453033298254,0.790458798409,-0.412232577801}},{{50,55,67},{-0.573373496532,0.156104639173,-0.804284930229}},{{46,50,68},{-0.548116624355,0.451883405447,-0.703824877739}},{{46,66,68},{-0.577350378036,0.577350199223,-0.577350258827}},{{50,67,68},{-0.634354412556,0.315754503012,-0.705615818501}},{{38,53,69},{0.80428481102,0.573373556137,0.156104817986}},{{59,63,70},{-0.548116624355,-0.451883405447,-0.703824877739}},{{38,57,71},{0.889127850533,0.351251870394,0.293383538723}},{{38,69,71},{0.886871159077,0.434987843037,0.15570859611}},{{43,56,72},{0.70561593771,-0.634354293346,-0.315754413605}},{{9,20,73},{0.577350378036,0.577350199223,-0.577350258827}},{{20,30,73},{0.451883435249,0.703825056553,-0.548116564751}},{{63,65,74},{-0.451883435249,-0.703825056553,-0.548116564751}},{{63,70,74},{-0.577350378036,-0.577350199223,-0.577350258827}},{{15,54,75},{0.155708536506,-0.886871159077,-0.434987902641}},{{55,59,76},{-0.573373496532,-0.156104654074,-0.804284930229}},{{55,67,76},{-0.664708256721,0,-0.747103095055}},{{59,70,76},{-0.634354412556,-0.315754503012,-0.705615818501}},{{65,74,77},{-0.453033298254,-0.790458798409,-0.412232577801}},{{47,57,78},{0.910481631756,0.099728226662,0.401344716549}},{{47,58,78},{0.910481631756,-0.099728226662,0.401344716549}},{{57,71,78},{0.936773180962,0.168145269156,0.306892752647}},{{15,65,80},{-0.155708536506,-0.886871159077,-0.434987902641}},{{15,75,80},{0,-0.934172272682,-0.356822162867}},{{65,77,80},{-0.293383508921,-0.889127850533,-0.351251780987}},{{43,54,81},{0.453033268452,-0.790458858013,-0.412232577801}},{{43,72,81},{0.578957796097,-0.76862770319,-0.272065013647}},{{54,75,81},{0.293383508921,-0.889127850533,-0.351251780987}},{{84,85,86},{-0.70561593771,0.634354293346,0.315754413605}},{{18,24,87},{0.703824996948,-0.548116445541,0.451883494854}},{{18,58,87},{0.790458738804,-0.412232637405,0.453033328056}},{{70,74,88},{-0.703824996948,-0.548116445541,-0.451883494854}},{{9,26,89},{0.790458738804,0.412232637405,-0.453033328056}},{{9,73,89},{0.703824996948,0.548116445541,-0.451883494854}},{{85,86,90},{-0.80428481102,0.573373556137,0.156104817986}},{{30,73,91},{0.453033298254,0.790458798409,-0.412232577801}},{{24,39,92},{0.578957796097,-0.76862770319,0.272065013647}},{{24,87,92},{0.70561593771,-0.634354293346,0.315754413605}},{{29,30,93},{0.155708536506,0.886871159077,-0.434987902641}},{{30,91,93},{0.293383508921,0.889127850533,-0.351251780987}},{{77,80,95},{-0.306892693043,-0.936773180962,-0.168145298958}},{{58,78,96},{0.936773180962,-0.168145269156,0.306892752647}},{{58,87,96},{0.889127790928,-0.351251810789,0.293383538723}},{{73,89,97},{0.70561593771,0.634354293346,-0.315754413605}},{{73,91,97},{0.578957796097,0.76862770319,-0.272065013647}},{{74,77,98},{-0.578957796097,-0.76862770319,-0.272065013647}},{{74,88,98},{-0.70561593771,-0.634354293346,-0.315754413605}},{{72,81,99},{0.562708616257,-0.810753107071,-0.161363810301}},{{36,56,100},{0.886871099472,-0.434987902641,-0.15570859611}},{{56,72,100},{0.80428481102,-0.573373556137,-0.156104817986}},{{70,76,101},{-0.768627583981,-0.272065132856,-0.578957855701}},{{70,88,101},{-0.790458738804,-0.412232637405,-0.453033328056}},{{71,78,102},{0.985605955124,0.098668895662,0.137278944254}},{{78,96,102},{0.985605955124,-0.098668895662,0.137278944254}},{{75,80,103},{0,-0.983104348183,-0.183046191931}},{{80,95,103},{-0.137278944254,-0.985605955124,-0.098668910563}},{{91,93,104},{0.306892693043,0.936773180962,-0.168145298958}},{{93,94,104},{0.137278944254,0.985605955124,-0.098668910563}},{{75,81,105},{0.306892693043,-0.936773180962,-0.168145298958}},{{81,99,105},{0.401344746351,-0.910481631756,-0.099728271365}},{{75,103,105},{0.137278944254,-0.985605955124,-0.098668910563}},{{29,45,106},{-0.155708536506,0.886871159077,-0.434987902641}},{{45,64,106},{-0.293383508921,0.889127850533,-0.351251780987}},{{29,93,106},{0,0.934172272682,-0.356822162867}},{{93,94,106},{0,0.983104348183,-0.183046191931}},{{64,66,107},{-0.578957796097,0.76862770319,-0.272064983845}},{{87,92,108},{0.80428481102,-0.573373556137,0.156104817986}},{{87,96,108},{0.886871159077,-0.434987843037,0.15570859611}},{{72,92,108},{0.747102975845,-0.664708435535,0}},{{36,100,108},{0.934172332287,-0.356822133064,0}},{{72,100,108},{0.747102916241,-0.664708375931,0}},{{36,96,108},{0.934172272682,-0.356822133064,0}},{{26,32,109},{0.936773180962,0.168145269156,-0.306892752647}},{{26,89,109},{0.889127790928,0.351251810789,-0.293383538723}},{{39,92,110},{0.562708616257,-0.810753107071,0.161363810301}},{{72,99,110},{0.662436962128,-0.749117612839,0}},{{72,92,110},{0.662436962128,-0.749117672443,0}},{{52,61,111},{-0.662436962128,-0.749117612839,0}},{{77,95,111},{-0.401344746351,-0.910481631756,-0.099728271365}},{{52,98,111},{-0.662436962128,-0.749117672443,0}},{{77,98,111},{-0.562708616257,-0.810753107071,-0.161363810301}},{{53,62,112},{0.662436962128,0.749117612839,0}},{{53,97,112},{0.662436962128,0.749117672443,0}},{{91,97,112},{0.562708616257,0.810753107071,-0.161363810301}},{{91,104,112},{0.401344746351,0.910481631756,-0.099728271365}},{{85,90,115},{-0.886871159077,0.434987843037,0.15570859611}},{{64,107,117},{-0.562708616257,0.810753107071,-0.161363810301}},{{88,101,118},{-0.889127850533,-0.351251870394,-0.293383538723}},{{101,113,118},{-0.936773180962,-0.168145269156,-0.306892752647}},{{84,85,119},{-0.703824996948,0.548116445541,0.451883494854}},{{84,114,119},{-0.577350378036,0.577350199223,0.577350318432}},{{64,106,120},{-0.306892693043,0.936773180962,-0.168145298958}},{{94,106,120},{-0.137278944254,0.985605955124,-0.098668910563}},{{64,117,120},{-0.401344746351,0.910481631756,-0.099728271365}},{{53,69,121},{0.747102916241,0.664708375931,0}},{{69,71,121},{0.934172332287,0.356822133064,0}},{{89,97,121},{0.80428481102,0.573373556137,-0.156104817986}},{{89,109,121},{0.886871159077,0.434987843037,-0.15570859611}},{{71,109,121},{0.934172272682,0.356822133064,0}},{{53,97,121},{0.747102975845,0.664708435535,0}},{{52,60,122},{-0.747102916241,-0.664708375931,0}},{{88,98,122},{-0.80428481102,-0.573373556137,-0.156104817986}},{{52,98,122},{-0.747102975845,-0.664708435535,0}},{{88,118,122},{-0.886871159077,-0.434987843037,-0.15570859611}},{{79,82,123},{-0.099728405476,0.401345044374,0.910481393337}},{{16,41,124},{0,-0.662436842918,0.749117851257}},{{85,115,125},{-0.889127850533,0.351251870394,0.293383538723}},{{85,119,125},{-0.790458798409,0.412232667208,0.453033328056}},{{114,119,126},{-0.548116624355,0.451883405447,0.703824877739}},{{114,123,126},{-0.412232339382,0.453033298254,0.790458977222}},{{115,116,127},{-0.985605955124,0.098668895662,0.137278944254}},{{115,125,127},{-0.936773180962,0.168145269156,0.306892752647}},{{40,41,130},{-0.272064954042,-0.578957617283,0.768627762794}},{{41,124,130},{-0.161363765597,-0.562708556652,0.810753285885}},{{124,129,130},{-0.099728405476,-0.401345044374,0.910481393337}},{{23,34,132},{-0.183045729995,0,-0.983104467392}},{{16,17,133},{0.27206492424,-0.578957617283,0.768627822399}},{{16,124,133},{0.161363765597,-0.562708556652,0.810753285885}},{{124,129,133},{0.099728405476,-0.401345044374,0.910481393337}},{{125,127,134},{-0.910481572151,0.099728226662,0.401344686747}},{{14,51,135},{0,-0.662436842918,-0.749117851257}},{{22,51,135},{-0.161363765597,-0.562708556652,-0.810753285885}},{{40,130,136},{-0.412232339382,-0.453033298254,0.790458977222}},{{14,54,137},{0.315754413605,-0.705615997314,-0.634354293346}},{{43,54,137},{0.451883405447,-0.703825056553,-0.548116564751}},{{40,136,138},{-0.548116624355,-0.451883405447,0.703824877739}},{{128,136,138},{-0.634354293346,-0.315754503012,0.705615818501}},{{22,23,139},{-0.168145462871,-0.306893110275,-0.936773002148}},{{23,132,139},{-0.098668709397,-0.137278482318,-0.985605955124}},{{22,135,139},{-0.099728420377,-0.401345074177,-0.910481452942}},{{127,134,140},{-0.910481631756,-0.099728226662,0.401344716549}},{{128,134,140},{-0.810753166676,-0.161363765597,0.562708675861}},{{128,138,140},{-0.768627643585,-0.272065132856,0.578957855701}},{{128,136,142},{-0.573373436928,-0.156104624271,0.804284930229}},{{6,7,144},{0.155708536506,0.886871159077,0.434987902641}},{{7,37,144},{0.293383508921,0.889127850533,0.351251780987}},{{6,143,144},{0,0.934172272682,0.356822162867}},{{37,62,145},{0.401344746351,0.910481631756,0.099728271365}},{{62,112,145},{0.403355509043,0.91504329443,0}},{{104,112,145},{0.403355509043,0.91504329443,0}},{{37,144,145},{0.306892693043,0.936773180962,0.168145298958}},{{4,5,146},{0.27206492424,0.578957617283,0.768627822399}},{{4,79,146},{0.161363765597,0.562708556652,0.810753285885}},{{79,82,146},{0.099728405476,0.401345044374,0.910481393337}},{{12,13,147},{0.573373496532,-0.156104654074,-0.804284930229}},{{129,133,148},{0.168145433068,-0.306893110275,0.936773002148}},{{129,131,148},{0.098668709397,-0.137278482318,0.985605955124}},{{2,47,149},{0.749117672443,0,0.662436962128}},{{47,58,149},{0.810753166676,-0.161363765597,0.562708675861}},{{18,58,149},{0.768627583981,-0.272065132856,0.578957855701}},{{2,141,149},{0.664708256721,0,0.747103095055}},{{82,123,150},{-0.168145433068,0.306893110275,0.936773002148}},{{123,126,150},{-0.351251721382,0.293383926153,0.889127790928}},{{126,142,150},{-0.434988111258,0.155708387494,0.886871039867}},{{82,131,150},{-0.098668709397,0.137278482318,0.985605955124}},{{14,135,151},{0.161363765597,-0.562708556652,-0.810753285885}},{{14,137,151},{0.27206492424,-0.578957617283,-0.768627822399}},{{135,139,151},{0.099728405476,-0.401345044374,-0.910481393337}},{{137,147,151},{0.412232339382,-0.453033298254,-0.790458977222}},{{44,49,152},{-0.306892693043,-0.936773180962,0.168145298958}},{{44,61,152},{-0.401344746351,-0.910481631756,0.099728271365}},{{61,111,152},{-0.403355509043,-0.91504329443,0}},{{95,111,152},{-0.403355509043,-0.91504329443,0}},{{84,86,153},{-0.578957796097,0.76862770319,0.272065013647}},{{3,143,153},{-0.306892722845,0.936773180962,0.168145298958}},{{82,146,154},{0.168145433068,0.306893110275,0.936773002148}},{{131,148,154},{0.183045729995,0,0.983104467392}},{{141,148,154},{0.356822550297,0,0.934172213078}},{{82,131,154},{0.098668709397,0.137278482318,0.985605955124}},{{67,68,155},{-0.768627643585,0.272065132856,-0.578957855701}},{{83,113,155},{-0.936773180962,0.168145269156,-0.306892752647}},{{12,21,156},{0.356822550297,0,-0.934172213078}},{{21,132,156},{0.183045729995,0,-0.983104467392}},{{132,139,156},{0.098668716848,-0.137278482318,-0.985605955124}},{{12,147,156},{0.43498814106,-0.155708402395,-0.886870980263}},{{139,151,156},{0.168145433068,-0.306893110275,-0.936773002148}},{{147,151,156},{0.35125169158,-0.293383896351,-0.889127731323}},{{60,122,157},{-0.934172332287,-0.356822133064,0}},{{118,122,157},{-0.934172272682,-0.356822133064,0}},{{116,127,157},{-0.985605955124,-0.098668895662,0.137278944254}},{{127,140,157},{-0.936773180962,-0.168145269156,0.306892752647}},{{86,90,158},{-0.747102916241,0.664708375931,0}},{{90,115,158},{-0.934172332287,0.356822133064,0}},{{83,115,158},{-0.934172272682,0.356822133064,0}},{{86,107,158},{-0.747102975845,0.664708435535,0}},{{44,52,159},{-0.578957796097,-0.76862770319,0.272064983845}},{{40,138,159},{-0.577350378036,-0.577350199223,0.577350258827}},{{39,48,160},{0.306892693043,-0.936773180962,0.168145298958}},{{99,105,160},{0.403355509043,-0.91504329443,0}},{{39,110,160},{0.401344746351,-0.910481631756,0.099728271365}},{{99,110,160},{0.403355509043,-0.91504329443,0}},{{48,49,161},{0,-0.983104348183,0.183046191931}},{{95,103,161},{-0.13795208931,-0.990438878536,0}},{{103,105,161},{0.13795208931,-0.990438878536,0}},{{49,152,161},{-0.137278944254,-0.985605955124,0.098668910563}},{{95,152,161},{-0.13795208931,-0.990438878536,0}},{{48,160,161},{0.137278944254,-0.985605955124,0.098668910563}},{{105,160,161},{0.13795208931,-0.990438878536,0}},{{119,125,162},{-0.768627583981,0.272065132856,0.578957855701}},{{119,126,162},{-0.634354352951,0.315754503012,0.705615818501}},{{125,134,162},{-0.810753166676,0.161363765597,0.562708675861}},{{128,134,162},{-0.749117672443,0,0.662436962128}},{{128,142,162},{-0.664708256721,0,0.747103095055}},{{126,142,162},{-0.573373496532,0.156104639173,0.804284930229}},{{4,6,163},{0,0.74710303545,0.664708197117}},{{79,123,163},{-0.161363765597,0.562708556652,0.810753285885}},{{114,123,163},{-0.272064954042,0.578957617283,0.768627762794}},{{4,79,163},{0,0.662436842918,0.749117851257}},{{84,114,164},{-0.451883405447,0.703825056553,0.548116564751}},{{6,143,164},{-0.155708536506,0.886871159077,0.434987902641}},{{84,153,164},{-0.453033268452,0.790458858013,0.412232577801}},{{143,153,164},{-0.293383479118,0.889127910137,0.351251810789}},{{6,163,164},{-0.15610472858,0.804284870625,0.573373436928}},{{114,163,164},{-0.315754413605,0.705615997314,0.634354293346}},{{17,18,165},{0.548116624355,-0.451883405447,0.703824877739}},{{17,133,165},{0.412232339382,-0.453033298254,0.790458977222}},{{133,148,165},{0.351251721382,-0.293383926153,0.889127790928}},{{18,149,165},{0.634354352951,-0.315754503012,0.705615818501}},{{141,149,165},{0.573373496532,-0.156104654074,0.804284930229}},{{141,148,165},{0.43498814106,-0.155708402395,0.886870980263}},{{113,118,166},{-0.985605955124,-0.098668895662,-0.137278944254}},{{115,116,166},{-0.983104348183,0.183046191931,0}},{{83,113,166},{-0.985605955124,0.098668895662,-0.137278944254}},{{118,157,166},{-0.983104348183,-0.18304617703,0}},{{116,157,166},{-0.983104348183,-0.18304617703,0}},{{83,115,166},{-0.983104348183,0.18304617703,0}},{{94,104,167},{0.13795208931,0.990438878536,0}},{{94,120,167},{-0.13795208931,0.990438878536,0}},{{3,120,167},{-0.13795208931,0.990438878536,0}},{{143,144,167},{0,0.983104348183,0.183046191931}},{{104,145,167},{0.13795208931,0.990438878536,0}},{{144,145,167},{0.137278944254,0.985605955124,0.098668910563}},{{3,143,167},{-0.137278944254,0.985605955124,0.098668910563}},{{52,60,168},{-0.804284870625,-0.573373556137,0.156104803085}},{{138,140,168},{-0.790458738804,-0.412232637405,0.453033328056}},{{60,157,168},{-0.886871099472,-0.434987902641,0.155708581209}},{{140,157,168},{-0.889127790928,-0.351251810789,0.293383538723}},{{52,159,168},{-0.70561593771,-0.634354293346,0.315754413605}},{{138,159,168},{-0.703824996948,-0.548116445541,0.451883494854}},{{66,68,169},{-0.703824996948,0.548116445541,-0.451883494854}},{{66,107,169},{-0.70561593771,0.634354293346,-0.315754413605}},{{68,155,169},{-0.790458738804,0.412232637405,-0.453033328056}},{{83,155,169},{-0.889127850533,0.351251840591,-0.293383538723}},{{83,158,169},{-0.886871099472,0.434987902641,-0.15570859611}},{{107,158,169},{-0.804284870625,0.573373556137,-0.156104803085}},{{41,42,170},{-0.156104743481,-0.804284930229,0.573373556137}},{{42,49,170},{-0.155708536506,-0.886871159077,0.434987902641}},{{40,41,170},{-0.315754413605,-0.705615997314,0.634354293346}},{{44,49,170},{-0.293383508921,-0.889127850533,0.351251810789}},{{44,159,170},{-0.453033268452,-0.790458917618,0.412232607603}},{{40,159,170},{-0.451883435249,-0.703825056553,0.548116564751}},{{13,25,171},{0.768627643585,-0.272065132856,-0.578957855701}},{{25,56,171},{0.790458798409,-0.412232637405,-0.453033328056}},{{43,56,171},{0.703824996948,-0.548116445541,-0.451883494854}},{{43,137,171},{0.577350378036,-0.577350199223,-0.577350318432}},{{13,147,171},{0.634354293346,-0.315754503012,-0.705615818501}},{{137,147,171},{0.548116624355,-0.451883405447,-0.703824877739}},{{28,35,172},{-0.099728405476,0.401345044374,-0.910481393337}},{{34,35,172},{-0.168145433068,0.306893110275,-0.936773002148}},{{34,132,172},{-0.098668709397,0.137278482318,-0.985605955124}},{{21,132,172},{0.098668709397,0.137278482318,-0.985605955124}},{{11,20,173},{0.412232339382,0.453033298254,-0.790458977222}},{{11,21,173},{0.35125169158,0.293383896351,-0.889127731323}},{{20,27,173},{0.272064954042,0.578957617283,-0.768627762794}},{{27,28,173},{0.161363765597,0.562708556652,-0.810753285885}},{{28,172,173},{0.099728405476,0.401345044374,-0.910481393337}},{{21,172,173},{0.168145433068,0.306893110275,-0.936773002148}},{{129,130,174},{-0.168145433068,-0.306893110275,0.936773002148}},{{130,136,174},{-0.351251721382,-0.293383926153,0.889127790928}},{{136,142,174},{-0.434988111258,-0.155708387494,0.886871039867}},{{129,131,174},{-0.098668709397,-0.137278482318,0.985605955124}},{{142,150,174},{-0.356822550297,0,0.934172213078}},{{131,150,174},{-0.183045729995,0,0.983104467392}},{{107,117,175},{-0.662436962128,0.749117612839,0}},{{117,120,175},{-0.403355509043,0.91504329443,0}},{{86,153,175},{-0.562708616257,0.810753107071,0.161363810301}},{{3,153,175},{-0.401344716549,0.910481631756,0.099728278816}},{{86,107,175},{-0.662436962128,0.749117672443,0}},{{3,120,175},{-0.403355509043,0.91504329443,0}},{{32,36,176},{0.985605955124,-0.098668895662,-0.137278944254}},{{71,102,176},{0.983104348183,0.183046191931,0}},{{96,102,176},{0.983104348183,-0.183046191931,0}},{{36,96,176},{0.983104348183,-0.18304617703,0}},{{32,109,176},{0.985605955124,0.098668895662,-0.137278944254}},{{71,109,176},{0.983104348183,0.18304617703,0}},{{67,76,177},{-0.749117672443,0,-0.662436962128}},{{76,101,177},{-0.810753166676,-0.161363765597,-0.562708675861}},{{101,113,177},{-0.910481572151,-0.099728226662,-0.401344686747}},{{67,155,177},{-0.810753166676,0.161363765597,-0.562708675861}},{{113,155,177},{-0.910481631756,0.099728226662,-0.401344716549}},{{5,8,178},{0.548116624355,0.451883405447,0.703824877739}},{{2,8,178},{0.634354293346,0.315754503012,0.705615818501}},{{5,146,178},{0.412232339382,0.453033298254,0.790458977222}},{{2,141,178},{0.573373436928,0.156104624271,0.804284930229}},{{146,154,178},{0.351251721382,0.293383926153,0.889127790928}},{{141,154,178},{0.43498814106,0.155708402395,0.886870980263}} },
         { {-1.809017062187,-0.500000059605,0.690982937813},{1.335371732712,0.305521279573,-2.319648981094},{1.335371732712,0.305521279573,2.319648981094},{-0.519783854485,1.82971560955,1},{0.305521279573,1.319648981094,2.335371732712},{0.809017062187,1.118034005165,2.309016942978},{0,1.618034005165,2},{0.587785303593,1.538841724396,1.951056480408},{1.309016942978,0.809017062187,2.118033885956},{1.309016942978,0.809017062187,-2.118033885956},{1.618034005165,0,-2},{0.951056540012,0.587785303593,-2.538841724396},{1.000000119209,0,-2.618033885956},{1.335371732712,-0.305521279573,-2.319648981094},{0.305521279573,-1.319648981094,-2.335371732712},{0,-1.618034005165,-2},{0.305521279573,-1.319648981094,2.335371732712},{0.809017062187,-1.118034005165,2.309016942978},{1.309016942978,-0.809017062187,2.118033885956},{0.587785303593,-1.538841724396,1.951056480408},{0.809017062187,1.118034005165,-2.309016942978},{0.500000059605,0.309017032385,-2.809017181396},{-0.494343847036,-0.82530516386,-2.640892982483},{-0.500000059605,-0.309017032385,-2.809017181396},{1.118034005165,-1.309016942978,1.809017062187},{1.640893101692,-0.494343847036,-1.825305223465},{1.640893101692,0.494343847036,-1.825305223465},{0.305521279573,1.319648981094,-2.335371732712},{0,1,-2.618033885956},{0,1.618034005165,-2},{0.587785303593,1.538841724396,-1.951056480408},{1.118034005165,1.309016942978,1.809017062187},{1.82971560955,0,-1.519783854485},{-0.305521279573,1.319648981094,-2.335371732712},{-0.500000059605,0.309017032385,-2.809017181396},{-0.494343847036,0.82530516386,-2.640892982483},{1.809017062187,-0.500000059605,-1.309017062187},{0.82530516386,1.640893101692,1.494343876839},{1.538841724396,0.951056540012,1.587785243988},{0.82530516386,-1.640893101692,1.494343876839},{-0.809017062187,-1.118034005165,2.309016942978},{-0.305521279573,-1.319648981094,2.335371732712},{0,-1.618034005165,2},{1.118034005165,-1.309016942978,-1.809017062187},{-0.82530516386,-1.640893101692,1.494343876839},{-0.587785303593,1.538841724396,-1.951056480408},{-0.809017062187,1.118034005165,-2.309016942978},{1.618034005165,0,2},{0.309017032385,-1.809017062187,1.5},{-0.309017032385,-1.809017062187,1.5},{-0.951056540012,0.587785303593,-2.538841724396},{-0.305521279573,-1.319648981094,-2.335371732712},{-1.319648981094,-1.335371732712,1.305521249771},{1.319648981094,1.335371732712,1.305521249771},{0.587785303593,-1.538841724396,-1.951056480408},{-1.000000119209,0,-2.618033885956},{1.538841724396,-0.951056540012,-1.587785243988},{1.640893101692,0.494343847036,1.825305223465},{1.640893101692,-0.494343847036,1.825305223465},{-0.951056540012,-0.587785303593,-2.538841724396},{-1.618034005165,-1.000000119209,1},{-1,-1.618034005165,1},{1,1.618034005165,1},{-0.809017062187,-1.118034005165,-2.309016942978},{-0.82530516386,1.640893101692,-1.494343876839},{-0.587785303593,-1.538841724396,-1.951056480408},{-1.118034005165,1.309016942978,-1.809017062187},{-1.335371732712,0.305521279573,-2.319648981094},{-1.309016942978,0.809017062187,-2.118033885956},{1.618034005165,1.000000119209,1},{-1.309016942978,-0.809017062187,-2.118033885956},{1.809017062187,0.500000059605,1.309017062187},{1.319648981094,-1.335371732712,-1.305521249771},{1.118034005165,1.309016942978,-1.809017062187},{-1.118034005165,-1.309016942978,-1.809017062187},{0.309017032385,-1.809017062187,-1.5},{-1.335371732712,-0.305521279573,-2.319648981094},{-0.82530516386,-1.640893101692,-1.494343876839},{1.82971560955,0,1.519783854485},{0,1,2.618033885956},{-0.309017032385,-1.809017062187,-1.5},{0.82530516386,-1.640893101692,-1.494343876839},{0,0.519783854485,2.82971572876},{-1.809017062187,0.500000059605,-1.309017062187},{-1.118034005165,1.309016942978,1.809017062187},{-1.538841724396,0.951056540012,1.587785243988},{-1.319648981094,1.335371732712,1.305521249771},{1.538841724396,-0.951056540012,1.587785243988},{-1.538841724396,-0.951056540012,-1.587785243988},{1.538841724396,0.951056540012,-1.587785243988},{-1.618034005165,1.000000119209,1},{0.82530516386,1.640893101692,-1.494343876839},{1.319648981094,-1.335371732712,1.305521249771},{0.309017032385,1.809017062187,-1.5},{0,1.902113080025,-1},{-0.519783854485,-1.82971560955,-1},{1.809017062187,-0.500000059605,1.309017062187},{1.319648981094,1.335371732712,-1.305521249771},{-1.319648981094,-1.335371732712,-1.305521249771},{1,-1.618034005165,-1},{1.618034005165,-1.000000119209,-1},{-1.640893101692,-0.494343847036,-1.825305223465},{1.902113080025,0,1},{0,-1.902113080025,-1},{0.519783854485,1.82971560955,-1},{0.519783854485,-1.82971560955,-1},{-0.309017032385,1.809017062187,-1.5},{-1.319648981094,1.335371732712,-1.305521249771},{1.618034005165,-1.000000119209,1},{1.809017062187,0.500000059605,-1.309017062187},{1,-1.618034005165,1},{-1,-1.618034005165,-1},{1,1.618034005165,-1},{-1.82971560955,0,-1.519783854485},{-0.809017062187,1.118034005165,2.309016942978},{-1.809017062187,0.500000059605,1.309017062187},{-1.902113080025,0,1},{-1,1.618034005165,-1},{-1.809017062187,-0.500000059605,-1.309017062187},{-1.309016942978,0.809017062187,2.118033885956},{-0.519783854485,1.82971560955,-1},{1.618034005165,1.000000119209,-1},{-1.618034005165,-1.000000119209,-1},{-0.494343847036,0.82530516386,2.640892982483},{0,-1,2.618033885956},{-1.640893101692,0.494343847036,1.825305223465},{-0.951056540012,0.587785303593,2.538841724396},{-1.82971560955,0,1.519783854485},{-1.335371732712,-0.305521279573,2.319648981094},{0,-0.519783854485,2.82971572876},{-0.494343847036,-0.82530516386,2.640892982483},{0,0,2.902112960815},{0,0,-2.902112960815},{0.494343847036,-0.82530516386,2.640892982483},{-1.618034005165,0,2},{0,-1,-2.618033885956},{-0.951056540012,-0.587785303593,2.538841724396},{0.809017062187,-1.118034005165,-2.309016942978},{-1.309016942978,-0.809017062187,2.118033885956},{0,-0.519783854485,-2.82971572876},{-1.640893101692,-0.494343847036,1.825305223465},{1.000000119209,0,2.618033885956},{-1.000000119209,0,2.618033885956},{-0.309017032385,1.809017062187,1.5},{0.309017032385,1.809017062187,1.5},{0.519783854485,1.82971560955,1},{0.494343847036,0.82530516386,2.640892982483},{0.951056540012,-0.587785303593,-2.538841724396},{0.500000059605,-0.309017032385,2.809017181396},{1.335371732712,-0.305521279573,2.319648981094},{-0.500000059605,0.309017032385,2.809017181396},{0.494343847036,-0.82530516386,-2.640892982483},{-0.519783854485,-1.82971560955,1},{-0.82530516386,1.640893101692,1.494343876839},{0.500000059605,0.309017032385,2.809017181396},{-1.640893101692,0.494343847036,-1.825305223465},{0.500000059605,-0.309017032385,-2.809017181396},{-1.809017062187,-0.500000059605,1.309017062187},{-1.618034005165,1.000000119209,-1},{-1.118034005165,-1.309016942978,1.809017062187},{0.519783854485,-1.82971560955,1},{0,-1.902113080025,1},{-1.335371732712,0.305521279573,2.319648981094},{-0.305521279573,1.319648981094,2.335371732712},{-0.587785303593,1.538841724396,1.951056480408},{0.951056540012,-0.587785303593,2.538841724396},{-1.902113080025,0,-1},{0,1.902113080025,1},{-1.538841724396,-0.951056540012,1.587785243988},{-1.538841724396,0.951056540012,-1.587785243988},{-0.587785303593,-1.538841724396,1.951056480408},{1.309016942978,-0.809017062187,-2.118033885956},{0,0.519783854485,-2.82971572876},{0.494343847036,0.82530516386,-2.640892982483},{-0.500000059605,-0.309017032385,2.809017181396},{-1,1.618034005165,1},{1.902113080025,0,-1},{-1.618034005165,0,-2},{0.951056540012,0.587785303593,2.538841724396} },
      };

      return mesh;
   }

   void scaleMesh(float scale, geometry::types::triangleMesh_t & mesh_in)
   {
      scaleMesh({scale, scale, scale}, mesh_in);
   }

   void scaleMesh(
      const Vector3 & scale, geometry::types::triangleMesh_t & mesh_in
   )
   {
      const Vector3 scale_inv(1.0f/scale[0], 1.0f/scale[1], 1.0f/scale[2]);

      // Find the center of the mesh.
      const Vector3 center = averageVertex(mesh_in.numVerts, mesh_in.verts);

      for (unsigned int i = 0; i < mesh_in.numVerts; ++i)
      {
         mesh_in.verts[i] = scale * (mesh_in.verts[i] - center) + center;
      }

      for (unsigned int i = 0; i < mesh_in.numTriangles; ++i)
      {
         mesh_in.triangles[i].normal = scale_inv * mesh_in.triangles[i].normal;
         mesh_in.triangles[i].normal.Normalize();
      }
   }

   void scaleMesh(
      const Matrix33 & scale, geometry::types::triangleMesh_t & mesh_in
   )
   {
      // Find the center of the mesh.
      const Vector3 center = averageVertex(mesh_in.numVerts, mesh_in.verts);

      for (unsigned int i = 0; i < mesh_in.numVerts; ++i)
      {
         mesh_in.verts[i] = scale * (mesh_in.verts[i] - center) + center;
      }

      const Matrix33 scaleInvTrans((~scale).transpose());
      for (unsigned int i = 0; i < mesh_in.numTriangles; ++i)
      {
         mesh_in.triangles[i].normal = scaleInvTrans * mesh_in.triangles[i].normal;
         mesh_in.triangles[i].normal.Normalize();
      }
   }

   void rotateMesh(
      const Vector3 & rpy, geometry::types::triangleMesh_t & mesh_in
   )
   {
      // Generate a FRD->NED matrix
      Matrix33 R_poly_to_world(frd2NedMatrix(rpy));
      rotateMesh(R_poly_to_world, mesh_in);
   }

   void rotateMesh(
      const Matrix33 & R_poly_to_world, geometry::types::triangleMesh_t & mesh_in
   )
   {
      // Find the center of the mesh.
      Vector3 center;
      for (unsigned int i = 0; i < mesh_in.numVerts; ++i)
      {
         center += mesh_in.verts[i] / mesh_in.numVerts;
      }

      for (unsigned int i = 0; i < mesh_in.numVerts; ++i)
      {
         mesh_in.verts[i] = R_poly_to_world * (mesh_in.verts[i] - center) + center;
      }

      for (unsigned int i = 0; i < mesh_in.numTriangles; ++i)
      {
         mesh_in.triangles[i].normal = R_poly_to_world * mesh_in.triangles[i].normal;
      }
   }

   void translateMesh(
      const Vector3 & offset, geometry::types::triangleMesh_t & mesh_in
   )
   {
      for (unsigned int i = 0; i < mesh_in.numVerts; ++i)
      {
         mesh_in.verts[i] += offset;
      }
   }

   void applyTransformation(
      const geometry::types::transform_t & transform,
      geometry::types::triangleMesh_t & mesh_in
   )
   {
      scaleMesh(transform.scale, mesh_in);
      rotateMesh(transform.rotate, mesh_in);
      translateMesh(transform.translate, mesh_in);
   }

   geometry::types::shape_t defaultShape(
      geometry::types::enumShape_t shape_type
   )
   {
      geometry::types::shape_t default_shape;
      default_shape.shapeType = shape_type;

      switch(default_shape.shapeType)
      {
         case geometry::types::enumShape_t::CYLINDER:
         {
            default_shape.cylinder.radius = 1.f;
            default_shape.cylinder.height = 2.f;
            break;
         }
         case geometry::types::enumShape_t::SPHERE:
         {
            default_shape.sphere.radius = 1.902113047f;
            break;
         }
         case geometry::types::enumShape_t::CAPSULE:
         {
            default_shape.capsule.radius = 1.902113047f;
            default_shape.capsule.height = 2.f;
            break;
         }
         case geometry::types::enumShape_t::CUBE:
         {
            default_shape.cube.length = 2.f;
            default_shape.cube.width = 2.f;
            default_shape.cube.height = 2.f;
            break;
         }
         default:
            break;
      }

      return default_shape;
   }

   bool polyhedralShape(geometry::types::shape_t shape)
   {
      return polyhedralShape(shape.shapeType);
   }

   bool polyhedralShape(geometry::types::enumShape_t shape_type)
   {
      switch(shape_type)
      {
         case geometry::types::enumShape_t::CYLINDER:
         case geometry::types::enumShape_t::SPHERE:
         case geometry::types::enumShape_t::CAPSULE:
         {
            return false;
         }
         case geometry::types::enumShape_t::CUBE:
         default:
            return true;
      }

      return true;
   }

   geometry::types::triangleMesh_t loadShapeMesh(
      geometry::types::shape_t shape
   )
   {
      geometry::types::triangleMesh_t shape_mesh;

      geometry::types::shape_t default_shape = defaultShape(shape.shapeType);

      switch(shape.shapeType)
      {
         case geometry::types::enumShape_t::CAPSULE:
         {
            shape_mesh = loadCapsuleMesh();
            float mesh_radius = default_shape.capsule.radius;

            const Matrix33 scale(
               Matrix33::diag(
                  {
                     shape.capsule.radius / mesh_radius,
                     shape.capsule.radius / mesh_radius,
                     shape.capsule.radius / mesh_radius
                  }
               )
            );

            scaleMesh(scale, shape_mesh);

            float new_mesh_height = 2.f * shape.capsule.radius / mesh_radius;

            if (fabs(shape.capsule.height - new_mesh_height) > 1e-5f)
            {
               float delta_height = shape.capsule.height - new_mesh_height;
               for (unsigned int i = 0; i < shape_mesh.numVerts; ++i)
               {
                  if (shape_mesh.verts[i][2] > 0.f)
                  {
                     shape_mesh.verts[i][2] += delta_height/2.f;
                  }
                  if (shape_mesh.verts[i][2] < 0.f)
                  {
                     shape_mesh.verts[i][2] -= delta_height/2.f;
                  }
               }
            }

            break;
         }
         case geometry::types::enumShape_t::CYLINDER:
         {
            shape_mesh = loadCylinderMesh();
            float mesh_radius = default_shape.cylinder.radius;
            float mesh_height = default_shape.cylinder.height;

            // Scale the mesh according to the ratios between [desired mesh
            // radius / true mesh radius] and [desired mesh height / true mesh
            // height]
            const Matrix33 scale(
               Matrix33::diag(
                  {
                     shape.cylinder.radius / mesh_radius,
                     shape.cylinder.radius / mesh_radius,
                     shape.cylinder.height / mesh_height
                  }
               )
            );

            scaleMesh(scale, shape_mesh);

            break;
         }
         case geometry::types::enumShape_t::SPHERE:
         {
            shape_mesh = loadSphereMesh();
            float mesh_radius = default_shape.sphere.radius;

            // Scale the mesh according to the ratios between [desired mesh
            // radius / true mesh radius]
            const Matrix33 scale(
               Matrix33::diag(
                  {
                     shape.sphere.radius / mesh_radius,
                     shape.sphere.radius / mesh_radius,
                     shape.sphere.radius / mesh_radius
                  }
               )
            );

            scaleMesh(scale, shape_mesh);

            break;
         }
         case geometry::types::enumShape_t::CUBE:
         {
            shape_mesh = loadCubeMesh();

            float cube_length = default_shape.cube.length;
            float cube_width = default_shape.cube.width;
            float cube_height = default_shape.cube.height;

            const Matrix33 scale(
               Matrix33::diag(
                  {
                     shape.cube.length / cube_length,
                     shape.cube.width / cube_width,
                     shape.cube.height / cube_height,
                  }
               )
            );

            scaleMesh(scale, shape_mesh);

            break;
         }
         default:
         {
            std::cout << "Mesh loader doesn't recognize type " << static_cast<int>(shape.shapeType) << ", so you get a cube\n";
            shape_mesh = loadCubeMesh();
            break;
         }
      }

      return shape_mesh;
   }

   geometry::types::triangleMesh_t loadDefaultShapeMesh(
      geometry::types::enumShape_t shape_type
   )
   {
      geometry::types::shape_t default_shape = defaultShape(shape_type);
      return loadShapeMesh(default_shape);
   }

   data_triangleMesh_t loadDefaultShapeMeshData(
      geometry::types::enumShape_t shape_type, float scale
   )
   {
      geometry::types::triangleMesh_t temp_mesh = loadDefaultShapeMesh(shape_type);
      scaleMesh(scale, temp_mesh);
      data_triangleMesh_t temp_mesh_data;
      geometry::converters::to_pod(temp_mesh, &temp_mesh_data);

      return temp_mesh_data;
   }

   bool pointInsideAabb(
      const geometry::types::aabb_t & aabb,
      const Vector3 & p,
      float epsilon
   )
   {
      return (
         (
            (p[0] >= aabb.vertMin[0] - epsilon) &&
            (p[0] <= aabb.vertMax[0] + epsilon)
         ) &&
         (
            (p[1] >= aabb.vertMin[1] - epsilon) &&
            (p[1] <= aabb.vertMax[1] + epsilon)
         ) &&
         (
            (p[2] >= aabb.vertMin[2] - epsilon) &&
            (p[2] <= aabb.vertMax[2] + epsilon)
         )
      );
   }

   bool pointInsideMesh(
      const geometry::types::triangleMesh_t & mesh, const Vector3 & q
   )
   {
      bool inside = true;
      for (unsigned int i = 0; i < mesh.numTriangles; ++i)
      {
         for (unsigned int j = 0; j < 3; ++j)
         {
            const Vector3 & triangle_vert = mesh.verts[mesh.triangles[i].vertIds[j]];
            if (mesh.triangles[i].normal.dot(triangle_vert - q) < 0.f)
            {
               inside = false;
            }
         }
      }

      return inside;
   }

   bool pointInsideMesh(
      const geometry::types::triangleMesh_t & mesh,
      const Vector3 & q,
      float & distance
   )
   {
      distance = __FLT_MAX__;
      bool inside = true;
      for (unsigned int i = 0; i < mesh.numTriangles; ++i)
      {
         geometry::types::pointBaryCoord_t closestPointToQuery = geometry::triangle::closestPointToPoint(
            mesh.verts[mesh.triangles[i].vertIds[0]],
            mesh.verts[mesh.triangles[i].vertIds[1]],
            mesh.verts[mesh.triangles[i].vertIds[2]],
            q
         );

         float temp_distance = (q - closestPointToQuery.point).magnitude();
         if (temp_distance < distance)
         {
            distance = temp_distance;
         }

         for (unsigned int j = 0; j < 3; ++j)
         {
            const Vector3 & triangle_vert = mesh.verts[mesh.triangles[i].vertIds[j]];
            if (mesh.triangles[i].normal.dot(triangle_vert - q) < 0.f)
            {
               inside = false;
            }
         }
      }

      return inside;
   }

   bool rayIntersect(
      const geometry::types::aabb_t & aabb,
      const Vector3 & ray_start,
      const Vector3 & ray_unit,
      Vector3 & intersection
   )
   {
      Vector3 max_vert_normals[3] = {
         Vector3(0.f, 0.f, 1.f),
         Vector3(0.f, 1.f, 0.f),
         Vector3(1.f, 0.f, 0.f)
      };

      Vector3 min_vert_normals[3] = {
         Vector3(0.f, 0.f, -1.f),
         Vector3(0.f, -1.f, 0.f),
         Vector3(-1.f, 0.f, 0.f)
      };

      for (unsigned int i = 0; i < 3; ++i)
      {
         bool plane_intersect = geometry::plane::rayIntersect(
            max_vert_normals[i],
            aabb.vertMax,
            ray_start,
            ray_unit,
            intersection
         );

         if (pointInsideAabb(aabb, intersection, 1e-5f) && plane_intersect)
         {
            return true;
         }
      }

      for (unsigned int i = 0; i < 3; ++i)
      {
         bool plane_intersect = geometry::plane::rayIntersect(
            min_vert_normals[i],
            aabb.vertMin,
            ray_start,
            ray_unit,
            intersection
         );

         if (pointInsideAabb(aabb, intersection, 1e-5f) && plane_intersect)
         {
            return true;
         }
      }

      return false;
   }

   bool rayIntersect(
      const geometry::types::triangleMesh_t & mesh,
      const Vector3 & ray_start,
      const Vector3 & ray_unit,
      Vector3 & intersection
   )
   {
      for (unsigned int i = 0; i < mesh.numTriangles; ++i)
      {
         Vector3 verts[3] = {
            mesh.verts[mesh.triangles[i].vertIds[0]],
            mesh.verts[mesh.triangles[i].vertIds[1]],
            mesh.verts[mesh.triangles[i].vertIds[2]]
         };

         if (
            geometry::triangle::rayIntersect(
               verts[0], verts[1], verts[2], ray_start, ray_unit, intersection
            )
         )
         {
            return true;
         }
      }

      return false;
   }

   pointOnMesh_t closestPointToPoint(
      const geometry::types::triangleMesh_t & mesh, const Vector3 & q
   )
   {
      pointOnMesh_t near_point_meta;

      float close_dist = __FLT_MAX__;
      for (unsigned int i = 0; i < mesh.numTriangles; ++i)
      {
         geometry::types::pointBaryCoord_t v_close_b = \
         geometry::triangle::closestPointToPoint(
            mesh.verts[mesh.triangles[i].vertIds[0]],
            mesh.verts[mesh.triangles[i].vertIds[1]],
            mesh.verts[mesh.triangles[i].vertIds[2]],
            q
         );

         float temp_dist = (q - v_close_b.point).magnitude();
         if (temp_dist < close_dist)
         {
            close_dist = temp_dist;
            near_point_meta.point = v_close_b.point;
            near_point_meta.bary = v_close_b.bary;
            near_point_meta.triangleId = i;
         }
      }

      return near_point_meta;
   }

} // mesh

} // geometry
